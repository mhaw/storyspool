<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}StorySpool{% endblock %}</title>
    <link href="{{ url_for('static', filename='css/output.css', v=config.get('STATIC_VERSION', '1')) }}" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='brand/storyspool_mark.svg') }}">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js?v={{ config.get('STATIC_VERSION', '1') }}"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js?v={{ config.get('STATIC_VERSION', '1') }}"></script>
    <style>
        .auth-status { margin-left: auto; padding-right: 1rem; display: flex; align-items: center; }
        .auth-status button { margin-left: 0.5rem; padding: 0.25rem 0.5rem; border-radius: 0.25rem; border: 1px solid #ccc; background-color: #f0f0f0; cursor: pointer; }
    </style>
    <script>
      window.CONFIG = {{ {
        "firebase": {
          "apiKey": config.get("FIREBASE_WEB_API_KEY", ""),
          "authDomain": config.get("FIREBASE_AUTH_DOMAIN", ""),
          "projectId": config.get("FIREBASE_PROJECT_ID", "")
        }
      } | tojson }};
    </script>
</head>
<body class="flex flex-col min-h-screen bg-gray-50 dark:bg-gray-900">
    <header class="bg-white shadow-sm py-4">
        <nav class="container mx-auto flex items-center justify-between px-4">
            <a href="/" class="flex items-center">
                <img src="{{ url_for('static', filename='brand/storyspool_mark.svg') }}" alt="StorySpool Logo" class="h-8 w-auto">
                <span class="ml-2 text-xl font-semibold">StorySpool</span>
            </a>
            <div id="authStatus" class="auth-status">
                <span id="authMessage">Not signed in</span>
                <button id="signInButton" style="display: none;">Sign In</button>
                <button id="signOutButton" style="display: none;">Sign Out</button>
            </div>
        </nav>
    </header>
    <main class="flex-grow flex items-center justify-center px-6 py-16">
        {% block content %}{% endblock %}
    </main>
    <footer class="bg-gray-200 text-center py-4 mt-8 text-sm text-gray-600">
        &copy; 2024 StorySpool. All rights reserved.
    </footer>

    <!-- Firebase Web SDK config injected from env -->
    <script src="{{ url_for('static', filename='js/auth.js', v=config.get('STATIC_VERSION','1')) }}" defer></script>
</body>
</html>
